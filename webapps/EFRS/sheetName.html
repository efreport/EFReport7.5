<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="Cache-Control" content="no-cache, no-store">
    <meta http-equiv="expires" content="0">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="js/css/layui.css">
    <style>
        #un a {
            display: block;
            color: #333;
            transition: all .3s;
            margin: 5px 5px;
            border-bottom: 1px solid #D5D5D5
        }

        #un a:hover {
            background: #CCCCCC;
        }

        .cka {
            background: #CCCCCC
        }

        #un2 a {
            display: block;
            color: #333;
            transition: all .3s;
            margin: 5px 5px;
            border-bottom: 1px solid #D5D5D5
        }

        #un2 a:hover {
            background: #CCCCCC;
        }

        .cka2 {
            background: #CCCCCC
        }

        .trck {
            background: #CCCCCC
        }

        .cktd {
            background: #F7F7F7;
        }

        .layui-tab-title li {
            line-height: 20px;
            padding: 0 5px
        }

        .layui-tab-title .layui-this:after {
            height: 20px;
        }

        .layui-table tbody td {
            padding: 0;
        }

        .layui-table, .layui-table-view {
            margin: auto;
        }

        img:hover {
            background-color: #D5D5D5;
            border-radius: 2px;
            cursor: pointer;
        }

        select {
            height: 30px;
            border: 1px solid #ccc;
        }

        select:hover {
            box-shadow: 0 0 1px #44B4FF;
        }

        input:hover {
            box-shadow: 0 0 1px #44B4FF;
        }

    </style>
</head>
<body>


<div id="un2" style="white-space: nowrap;overflow: auto;height:200px;">

    <table id="tb2" class="layui-table" style="width: 100%;height:100%;text-align: center;">
        <tr style="display: block;width:100%;">
            <td style="width:49px;">状态</td>
            <td style="width:450px;">sheet名</td>
        </tr>
    </table>

</div>
</div>


</body>
<script type="text/javascript" src="js/jquery-1.11.3.min.js"></script>
<script type="text/javascript" src="js/layui.js" charset="utf-8"></script>

<script type="text/javascript">
    layui.use('layer', function() {
        var layer = layui.layer;
    });
    function init(data) {
        $.each(data, function (index, ele) {
            $('#tb2').append('<tr style="display: block;width:100%"> <td style="width:49px;"><input type="checkbox" checked></td> <td style="width:450px;">' + ele + '</td></tr>');
        });
    }
    function getSheetNames() { //获取所有模板INDEX
        var table = $('#tb2');
        var trs = table.find('tr'); //获取所有行
        var res = {};
        var sheets = [];
        $.each(trs, function (index, element) {
            if (index != 0) {
                var checkbox = $(this).find('td').eq(0).find('input[type="checkbox"]');
                var name = $(this).find('td').eq(1).text();
                if (checkbox.prop('checked')) {
                    sheets.push(name);
                }
            }
        });
        if(sheets.length == trs.length - 1){//全选
            res.chooseAll = 'Y';
        }else if(sheets.length == 0){ //未选择
            layer.alert('请选择sheet页!');
            return;
        }else{
            res.chooseAll = 'N';
            res.sheet = sheets;
        }
        return res;
    }

    function chooseAll(flag){
        var table = $('#tb2');
        var trs = table.find('tr'); //获取所有行
        var temps = [];
        if(flag == 1){ //全选
            $.each(trs, function (index, element) {
                if (index != 0) {
                    var checkbox = $(this).find('td').eq(0).find('input[type="checkbox"]');
                    checkbox.prop('checked' , 'checked');
                }
            });
        }else{
            $.each(trs, function (index, element) {
                if (index != 0) {
                    var checkbox = $(this).find('td').eq(0).find('input[type="checkbox"]');
                    checkbox.prop('checked' , false);
                }
            });
        }

    }

</script>
</html>