<!doctype html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="Cache-Control" content="no-cache, no-store">
    <meta http-equiv="expires" content="0">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="js/css/layui.css">
    <script type="text/javascript" src="js/jquery-1.11.3.min.js"></script>
    <script type="text/javascript" src="js/layui.js"></script>
    <style type="text/css">
        input[type="text"] {
            height: 40px;
            border: 1px solid #ccc;
            width: 95%;
            background-color: #F2F3F5;
        }

        input[type="checkbox"] {
            width: 18px;
            height: 18px;
            margin-right: 10px;
        }
    </style>
</head>
<body oncontextmenu="event.preventDefault()">
    <div id="container">
       <div id="fileDiv" style="padding: 10px;">
           <input type="text" id="factory" placeholder="导入文件" autocomplete="off" class="layui-input"
                  style="height: 34px;width: 80%;display: inline-block;margin: 2px" readonly>
           <button type="button" id="importU" class="layui-btn" data-type="reload"
                   style="height: 34px;line-height:34px;width: 15%;;background-color: #3E99DD;">浏览</button>
       </div>
        <div>
            <div class="layui-field-box">
                <label style="margin-right: 5px">开始单元格:</label><input type="text" id="start" style="width:100px;height:34px;" value="A1">(A1)
                <label style="margin-right: 5px;margin-left: 15px;">行数:</label><input type="text" id="rowNum" style="width:100px;height:34px;" value="1">(1-300)
            </div>
            <div class="layui-field-box" style="display: flex;align-items: center;">
                <label style="margin-right: 5px">是否替换公式单元格:</label><input type="checkbox" id="isReplace">
            </div>
        </div>

    </div>
</body>
<script type="text/javascript">
    //Excel内容
    var excelContent = '';
    var base;
    var token;
    $(document).ready(function(){


    })

    function init(base,token){
        base = base;
        token = token;
        layui.use('upload', function () {
            var upload = layui.upload;
            upload.render({
                elem:'#importU'
                ,url: base + '/designSys/getJsonData?token=' + token
                , accept: 'file'
                , exts: 'xlsx'
                , done: function (res) {
                }
                , before: function (obj) {
                    var files = obj.pushFile();
                    obj.preview(function (index, file, result) { //得到文件base64编码，比如图片
                        var ts = result.indexOf('base64,') + 7;
                        var tt = result.substr(ts, result.length);
                        excelContent = tt;
                        $('#factory').val(file.name);
                    });
                }
            });

        });
    }

    function getContent(){
        var content = {
            excel:'',
            cell:'',
            rowNum:'',
            isReplace:''
        }
        content.excel = excelContent;
        content.cell = $('#start').val();
        content.rowNum = $('#rowNum').val();
        content.isReplace = $('#isReplace').prop('checked');
        return content;

    }
</script>

</html>
